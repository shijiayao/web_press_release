"use strict";(self["webpackChunkfront_end"]=self["webpackChunkfront_end"]||[]).push([[589],{8872:function(e,a,t){t.r(a),t.d(a,{default:function(){return C}});var l=t(3396),o=t(7139);const i={class:"friend-links-wrap"},n={class:"head-box"},d=(0,l.Uk)("搜索"),r=(0,l.Uk)("新增友情链接"),s={class:"table-box"},u=["src"],c=(0,l.Uk)("编辑"),m=(0,l.Uk)("删除"),g=["src"],p={class:"dialog-footer"},b=(0,l.Uk)("取消"),w=(0,l.Uk)("新增"),h=(0,l.Uk)("修改");function f(e,a,t,f,k,D){const _=(0,l.up)("el-input"),y=(0,l.up)("el-button"),W=(0,l.up)("el-table-column"),z=(0,l.up)("el-popconfirm"),V=(0,l.up)("el-table"),U=(0,l.up)("el-form-item"),C=(0,l.up)("Plus"),R=(0,l.up)("el-icon"),B=(0,l.up)("el-upload"),x=(0,l.up)("el-form"),$=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.iD)("section",i,[(0,l._)("section",n,[(0,l.Wm)(_,{modelValue:k.headForm.name,"onUpdate:modelValue":a[0]||(a[0]=e=>k.headForm.name=e),placeholder:"名称",clearable:""},null,8,["modelValue"]),(0,l.Wm)(y,{type:"primary",onClick:D.headSearchButton},{default:(0,l.w5)((()=>[d])),_:1},8,["onClick"]),(0,l.Wm)(y,{type:"success",onClick:D.headAddButton},{default:(0,l.w5)((()=>[r])),_:1},8,["onClick"])]),(0,l._)("section",s,[(0,l.Wm)(V,{size:"default",data:k.tableData,border:"",style:{width:"100%"},"empty-text":"没有数据"},{default:(0,l.w5)((()=>[(0,l.Wm)(W,{"header-align":"center",align:"center",label:"#",width:"60"},{default:(0,l.w5)((e=>[(0,l.Uk)((0,o.zw)(e.$index+1),1)])),_:1}),(0,l.Wm)(W,{"header-align":"center",align:"left",prop:"name",label:"名称"}),(0,l.Wm)(W,{"header-align":"center",align:"left",prop:"link",label:"链接"}),(0,l.Wm)(W,{"header-align":"center",align:"center",prop:"image",label:"图片",width:"200"},{default:(0,l.w5)((e=>[(0,l._)("img",{src:e.row.image,alt:"",class:"row-image"},null,8,u)])),_:1}),(0,l.Wm)(W,{"header-align":"center",align:"center",label:"操作",width:"200"},{default:(0,l.w5)((e=>[(0,l.Wm)(y,{type:"primary",onClick:a=>D.rowEditButton(e)},{default:(0,l.w5)((()=>[c])),_:2},1032,["onClick"]),(0,l.Wm)(z,{"confirm-button-text":"是","cancel-button-text":"否","icon-color":"red",title:"确定要删除【"+e.row.name+"】吗?",onConfirm:a=>D.rowDeleteButton(e.row)},{reference:(0,l.w5)((()=>[(0,l.Wm)(y,{type:"warning"},{default:(0,l.w5)((()=>[m])),_:1})])),_:2},1032,["title","onConfirm"])])),_:1})])),_:1},8,["data"])]),(0,l.Wm)($,{modelValue:k.editDialogVisible,"onUpdate:modelValue":a[4]||(a[4]=e=>k.editDialogVisible=e),"close-on-click-modal":!1,"destroy-on-close":!0,"custom-class":"edit-dialog"},{footer:(0,l.w5)((()=>[(0,l._)("span",p,[(0,l.Wm)(y,{onClick:a[3]||(a[3]=e=>k.editDialogVisible=!1)},{default:(0,l.w5)((()=>[b])),_:1}),"add"===k.dialogMode?((0,l.wg)(),(0,l.j4)(y,{key:0,type:"primary",onClick:D.addDialogButton},{default:(0,l.w5)((()=>[w])),_:1},8,["onClick"])):((0,l.wg)(),(0,l.j4)(y,{key:1,type:"primary",onClick:D.editDialogButton},{default:(0,l.w5)((()=>[h])),_:1},8,["onClick"]))])])),default:(0,l.w5)((()=>[(0,l.Wm)(x,{"label-width":"80px",model:k.tableRowData},{default:(0,l.w5)((()=>[(0,l.Wm)(U,{label:"名称:"},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{modelValue:k.tableRowData.name,"onUpdate:modelValue":a[1]||(a[1]=e=>k.tableRowData.name=e),placeholder:"请输入友情链接名称"},null,8,["modelValue"])])),_:1}),(0,l.Wm)(U,{label:"网址:"},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{modelValue:k.tableRowData.link,"onUpdate:modelValue":a[2]||(a[2]=e=>k.tableRowData.link=e),placeholder:"请输入友情链接网址"},null,8,["modelValue"])])),_:1}),(0,l.Wm)(U,{label:"图片:",class:"upload-image"},{default:(0,l.w5)((()=>[(0,l.Wm)(B,{class:"avatar-uploader",action:D.uploadImageUrl,headers:D.uploadImageHeaders,name:"friend-links","show-file-list":!1,"list-type":"picture","on-success":D.imageUploadSuccess,"before-upload":D.imageUploadBefore},{default:(0,l.w5)((()=>[k.tableRowData.image?((0,l.wg)(),(0,l.iD)("img",{key:0,src:k.tableRowData.image,class:"image"},null,8,g)):((0,l.wg)(),(0,l.j4)(R,{key:1,class:"avatar-uploader-icon"},{default:(0,l.w5)((()=>[(0,l.Wm)(C)])),_:1}))])),_:1},8,["action","headers","on-success","before-upload"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])])}var k=t(9702),D=t.n(k),_=t(65),y=t(5574),W=t(9713),z={name:"friend-links",components:{},props:{},data(){return{headForm:{name:""},tableData:[],tableRowData:{},dialogMode:"",editDialogVisible:!1}},watch:{},computed:{...(0,_.Se)(["token"]),uploadImageHeaders:function(){return{Authorization:this.token,["X-Void-Risk"]:1}},uploadImageUrl:function(){let e=String(Math.random()).substring(2),a=(new Date).getTime(),t=D()(`/api/upload/image~${e}${a}`);return`//127.0.0.1:12580/api/upload/image?nonce=${e}&ts=${a}&s=${t}`}},beforeCreate(){},created(){this.getTableData()},beforeMount(){},mounted(){},beforeUpdate(){},updated(){},beforeUnmount(){},unmounted(){},methods:{getTableData(){const e=this;(0,W.Xe)(e.headForm).then((a=>{const{code:t,data:l,message:o}=a.data;200===t?e.tableData=l:y.z8.error(o)}))},headSearchButton(){this.getTableData()},headAddButton(){this.tableRowData={name:"",link:"",image:""},this.dialogMode="add",this.editDialogVisible=!0},rowEditButton(e){this.tableRowData={index:e.$index,...e.row},this.dialogMode="edit",this.editDialogVisible=!0},rowDeleteButton(e){const a=this;(0,W.Oo)({op_type:0,id:e.id}).then((e=>{const{code:t,message:l}=e.data;200===t?(y.z8.success(l),a.getTableData()):y.z8.error(l)}))},addDialogButton(){const e=this,{name:a,link:t,image:l}=e.tableRowData;a?t?l?(0,W.wF)(e.tableRowData).then((a=>{const{code:t,message:l}=a.data;200===t?(y.z8.success(l),e.getTableData(),e.editDialogVisible=!1):y.z8.error(l)})):y.z8.error("请上传图片"):y.z8.error("链接不能为空"):y.z8.error("名称不能为空")},editDialogButton(){const e=this,{index:a,id:t,name:l,link:o,image:i}=e.tableRowData;let n={op_type:1,id:t};l?(l!==e.tableData[a].name&&(n.name=l),o?(o!==e.tableData[a].link&&(n.link=o),i?(i!==e.tableData[a].image&&(n.image=i),Object.keys(n).length>2?(0,W.Oo)(n).then((a=>{const{code:t,message:l}=a.data;200===t?(y.z8.success(l),e.getTableData(),e.editDialogVisible=!1):y.z8.error(l)})):y.z8.warning("什么都没有更改！")):y.z8.error("请上传图片")):y.z8.error("链接不能为空")):y.z8.error("名称不能为空")},imageUploadBefore(e){let a=!0;return/image\//.test(e.type)||(a=!1,y.z8.error("请上传图片类型的文件！")),a},imageUploadSuccess(e){const{code:a,data:t,message:l}=e;10004===a?(y.z8.error(l),this.$router.push("/")):200===a?(this.tableRowData.image=t.url,y.z8.success(l)):y.z8.error(l)}}},V=t(89);const U=(0,V.Z)(z,[["render",f],["__scopeId","data-v-706b4ffc"]]);var C=U}}]);
//# sourceMappingURL=589.9a641da0.js.map